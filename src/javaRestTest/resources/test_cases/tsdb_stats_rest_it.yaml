# TSDB REST Integration Test - TSDB Stats Endpoint
# Test suite for /_tsdb/stats endpoint with real time series data

test_setup:
  name: "TSDB Stats Endpoint Tests"
  description: "Integration tests for /_tsdb/stats endpoint with various label cardinalities and value distributions"

  index_configs:
    - name: "tsdb_stats_test"
      shards: 1
      replicas: 0

test_case:
  name: "TSDB Stats Test Data"

  # Input data: HTTP request metrics with diverse label combinations
  input_data_list:
    - index_name: "tsdb_stats_test"
      input_data_type: FIXED_INTERVAL
      time_config:
        min_timestamp: "2025-01-01T00:00:00Z"
        max_timestamp: "2025-01-01T01:00:00Z"
        step: "5m"
      regular_metrics:
      # API service metrics - multiple label combinations
      - labels: "name:http_requests_total,service:api,method:GET,status:200,env:prod"
        values: [100,102,105,108,110,112,115,118,120,122,125,128,130]

      - labels: "name:http_requests_total,service:api,method:POST,status:200,env:prod"
        values: [50,52,55,58,60,62,65,68,70,72,75,78,80]

      - labels: "name:http_requests_total,service:api,method:GET,status:404,env:prod"
        values: [5,6,7,8,9,10,11,12,13,14,15,16,17]

      - labels: "name:http_requests_total,service:api,method:GET,status:200,env:staging"
        values: [20,22,24,26,28,30,32,34,36,38,40,42,44]

      # Web service metrics
      - labels: "name:http_requests_total,service:web,method:GET,status:200,env:prod"
        values: [200,205,210,215,220,225,230,235,240,245,250,255,260]

      - labels: "name:http_requests_total,service:web,method:POST,status:201,env:prod"
        values: [80,82,84,86,88,90,92,94,96,98,100,102,104]

      # Different metric names for testing label value variety
      - labels: "name:http_response_time_ms,service:api,method:GET,status:200,env:prod"
        values: [150,155,160,165,170,175,180,185,190,195,200,205,210]

      - labels: "name:http_response_time_ms,service:web,method:GET,status:200,env:prod"
        values: [100,105,110,115,120,125,130,135,140,145,150,155,160]

      # Database metrics with different label structure
      - labels: "name:db_connections,service:postgres,env:prod,pool:primary"
        values: [10,12,14,16,18,20,22,24,26,28,30,32,34]

      - labels: "name:db_connections,service:postgres,env:prod,pool:replica"
        values: [5,6,7,8,9,10,11,12,13,14,15,16,17]

  # Note: The actual _tsdb/stats queries will be tested in TSDBStatsRestIT.java
  # This YAML only provides the test data setup
  queries: []
